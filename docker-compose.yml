services:

  api-gateway:
    container_name: api-gateway
    build:
      context: api-gateway/
    networks:
      - transcendence
    ports:
      - "8000:8000"         #DEV
    depends_on:
      - database
    restart: unless-stopped
    develop:
      watch:
        - action: sync
          path: ./api-gateway/src/
          target: /app/src/
        - action: rebuild
          path: ./api-gateway/package.json
          target: app/


  frontend:
    container_name: frontend
    build:
      context: frontend/
    networks:
      - transcendence
    ports:
      - "3001:3001"
    depends_on:
      - api-gateway
    restart: unless-stopped
    develop:
      watch:
        - action: sync
          path: ./frontend/src/
          target: /app/src/
        - action: sync
          path: ./frontend/public/
          target: /app/public/
        - action: rebuild
          path: ./frontend/package.json
          target: app/

  user-management:
    container_name: user-management
    build:
      context: services/user-management/
    networks:
      - transcendence
    ports:
      - "8001:8001"         #DEV
    depends_on:
      - api-gateway
    restart: unless-stopped
    develop:
      watch:
        - action: sync
          path: ./services/user-management/src/
          target: /app/src/
        - action: rebuild
          path: ./services/user-management/package.json
          target: app/

  database:
    container_name: database
    build:
      context: services/database/
    networks:
      - transcendence
    restart: unless-stopped
    develop:
      watch:
        - action: sync
          path: ./services/database/src/
          target: /app/src/
        - action: rebuild
          path: ./services/database/package.json
          target: app/

#
#  ai-opponent:
#    container_name: ai-opponent
#    build:
#      context: services/ai-opponent/
#    networks:
#      - transcendence
#    restart: unless-stopped
#    develop:
#      watch:
#        - action: sync
#          path: ./services/ai-opponent/src/
#          target: /app/src/
#        - action: rebuild
#          path: ./services/ai-opponent/package.json
#          target: app/
#
#  live-chat:
#    container_name: live-chat
#    build:
#      context: services/live-chat/
#    networks:
#      - transcendence
#    restart: unless-stopped
#    develop:
#      watch:
#        - action: sync
#          path: ./services/live-chat/src/
#          target: /app/src/
#        - action: rebuild
#          path: ./services/live-chat/package.json
#          target: app/
#
#  match-server:
#    container_name: match-server
#    build:
#      context: services/match-server/
#    networks:
#      - transcendence
#    restart: unless-stopped
#    develop:
#      watch:
#        - action: sync
#          path: ./services/match-server/src/
#          target: /app/src/
#        - action: rebuild
#          path: ./services/match-server/package.json
#          target: app/


networks:
  transcendence:
    name: transcendence
    driver: bridge
